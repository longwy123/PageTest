<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>现代贪吃蛇 - GamePortal</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&family=Noto+Serif+SC:wght@400;600;700&display=swap"
        rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3b82f6',
                        secondary: '#10b981',
                        accent: '#f59e0b',
                        dark: '#1e293b',
                        light: '#f8fafc'
                    },
                    fontFamily: {
                        sans: ['Noto Sans SC', 'sans-serif'],
                        serif: ['Noto Serif SC', 'serif']
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .text-shadow {
                text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            }
            .text-gradient {
                background-clip: text;
                -webkit-background-clip: text;
                color: transparent;
            }
            .bg-blur {
                backdrop-filter: blur(8px);
            }
        }
    </style>
    <style>
        /* 贪吃蛇游戏样式 */
        #game-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
        }

        #game-board {
            position: relative;
            width: 100%;
            aspect-ratio: 1/1;
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            border-radius: 0.75rem;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .snake {
            position: absolute;
            width: 4%;
            height: 4%;
            border-radius: 4px;
            transition: all 0.08s linear;
            z-index: 10;
        }

        .food {
            position: absolute;
            width: 4%;
            height: 4%;
            border-radius: 50%;
            z-index: 5;
            animation: pulse 1s infinite alternate;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                opacity: 1;
            }

            100% {
                transform: scale(1.1);
                opacity: 0.8;
            }
        }

        .obstacle {
            position: absolute;
            width: 4%;
            height: 4%;
            background: linear-gradient(45deg, #ef4444, #dc2626);
            border-radius: 4px;
            z-index: 5;
        }

        .power-up {
            position: absolute;
            width: 4%;
            height: 4%;
            background: linear-gradient(45deg, #8b5cf6, #7c3aed);
            border-radius: 50%;
            z-index: 5;
            animation: glow 1.5s infinite alternate;
        }

        @keyframes glow {
            0% {
                box-shadow: 0 0 5px rgba(139, 92, 246, 0.5);
            }

            100% {
                box-shadow: 0 0 20px rgba(139, 92, 246, 0.8);
            }
        }

        .score-board {
            background: rgba(30, 41, 59, 0.8);
            backdrop-filter: blur(10px);
            border-radius: 0.5rem;
            border: 1px solid rgba(75, 85, 99, 0.5);
        }

        .control-btn {
            transition: all 0.2s ease;
        }

        .control-btn:hover {
            transform: scale(1.05);
        }

        .control-btn:active {
            transform: scale(0.95);
        }

        /* 响应式控制 */
        @media (max-width: 768px) {
            #game-board {
                max-width: 300px;
                margin: 0 auto;
            }
        }
    </style>
</head>

<body class="bg-gray-900 text-light font-sans min-h-screen flex flex-col">
    <!-- 导航栏 -->
    <header class="fixed top-0 left-0 right-0 z-50 bg-dark/90 bg-blur border-b border-gray-800">
        <nav class="container mx-auto px-4 py-3 flex items-center justify-between">
            <div class="flex items-center space-x-2">
                <div class="w-10 h-10 rounded-lg bg-primary flex items-center justify-center">
                    <i class="fa fa-gamepad text-xl"></i>
                </div>
                <span
                    class="text-2xl font-bold bg-gradient-to-r from-primary to-secondary text-gradient">GamePortal</span>
            </div>

            <!-- 主导航 -->
            <div class="hidden md:flex items-center space-x-8">
                <a href="index.html" class="font-medium hover:text-primary transition-colors">首页</a>
                <a href="games.html" class="font-medium text-primary border-b-2 border-primary pb-1">游戏库</a>
                <a href="downloads.html" class="font-medium hover:text-primary transition-colors">资源下载</a>
                <a href="community.html" class="font-medium hover:text-primary transition-colors">社区</a>
            </div>

            <!-- 用户操作 -->
            <div class="flex items-center space-x-4 user-actions">
                <button
                    class="hidden md:block px-4 py-2 rounded-lg bg-primary/20 hover:bg-primary/30 transition-colors">
                    <i class="fa fa-search mr-2"></i>搜索
                </button>
                <a href="login.html"
                    class="px-4 py-2 rounded-lg border border-gray-700 hover:border-primary transition-colors">
                    登录
                </a>
                <a href="register.html" class="px-4 py-2 rounded-lg bg-primary hover:bg-primary/90 transition-colors">
                    注册
                </a>
                <button class="md:hidden text-xl">
                    <i class="fa fa-bars"></i>
                </button>
            </div>
        </nav>
    </header>

    <!-- 游戏内容 -->
    <main class="flex-1 pt-32 pb-20">
        <div class="container mx-auto px-4">
            <!-- 游戏标题 -->
            <div class="text-center mb-12">
                <h1 class="text-4xl font-bold mb-2">现代贪吃蛇</h1>
                <p class="text-xl text-gray-400">流畅的游戏体验，全新的视觉效果</p>
                <div class="flex justify-center items-center gap-4 mt-4">
                    <span class="px-3 py-1 rounded-full bg-primary/20 text-primary text-sm">休闲</span>
                    <span class="px-3 py-1 rounded-full bg-gray-700 text-sm">单人</span>
                    <span class="px-3 py-1 rounded-full bg-gray-700 text-sm">HTML5</span>
                </div>
            </div>

            <!-- 游戏区域 -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- 游戏主区域 -->
                <div class="lg:col-span-2 space-y-6">
                    <div class="bg-gray-800/50 border border-gray-700 rounded-xl p-6">
                        <div id="game-container">
                            <div id="game-board"></div>

                            <!-- 游戏信息 -->
                            <div class="grid grid-cols-3 gap-4 mt-6 score-board p-4">
                                <div class="text-center">
                                    <div class="text-sm text-gray-400 mb-1">分数</div>
                                    <div class="text-2xl font-bold" id="score">0</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-sm text-gray-400 mb-1">长度</div>
                                    <div class="text-2xl font-bold" id="length">1</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-sm text-gray-400 mb-1">等级</div>
                                    <div class="text-2xl font-bold" id="level">1</div>
                                </div>
                            </div>

                            <!-- 游戏控制 -->
                            <div class="flex flex-col md:flex-row justify-center gap-4 mt-6">
                                <button id="start-btn"
                                    class="px-6 py-3 rounded-lg bg-primary hover:bg-primary/90 transition-colors font-medium control-btn">
                                    <i class="fa fa-play mr-2"></i>开始游戏
                                </button>
                                <button id="pause-btn"
                                    class="px-6 py-3 rounded-lg bg-gray-700 hover:bg-gray-600 transition-colors font-medium control-btn"
                                    disabled>
                                    <i class="fa fa-pause mr-2"></i>暂停
                                </button>
                                <button id="reset-btn"
                                    class="px-6 py-3 rounded-lg bg-gray-700 hover:bg-gray-600 transition-colors font-medium control-btn">
                                    <i class="fa fa-refresh mr-2"></i>重置
                                </button>
                            </div>

                            <!-- 移动端控制 -->
                            <div class="mt-8 md:hidden">
                                <div class="flex justify-center mb-2">
                                    <button
                                        class="w-16 h-16 rounded-lg bg-gray-700 hover:bg-gray-600 transition-colors control-btn"
                                        data-direction="up">
                                        <i class="fa fa-arrow-up text-xl"></i>
                                    </button>
                                </div>
                                <div class="flex justify-center gap-4">
                                    <button
                                        class="w-16 h-16 rounded-lg bg-gray-700 hover:bg-gray-600 transition-colors control-btn"
                                        data-direction="left">
                                        <i class="fa fa-arrow-left text-xl"></i>
                                    </button>
                                    <button
                                        class="w-16 h-16 rounded-lg bg-gray-700 hover:bg-gray-600 transition-colors control-btn"
                                        data-direction="down">
                                        <i class="fa fa-arrow-down text-xl"></i>
                                    </button>
                                    <button
                                        class="w-16 h-16 rounded-lg bg-gray-700 hover:bg-gray-600 transition-colors control-btn"
                                        data-direction="right">
                                        <i class="fa fa-arrow-right text-xl"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 游戏信息 -->
                <div class="lg:col-span-1 space-y-6">
                    <!-- 游戏详情 -->
                    <div class="bg-gray-800/50 border border-gray-700 rounded-xl p-6">
                        <h3 class="text-xl font-bold mb-4">游戏详情</h3>
                        <div class="space-y-4">
                            <div>
                                <h4 class="font-medium mb-2">游戏介绍</h4>
                                <p class="text-gray-300">
                                    现代贪吃蛇是一款重新设计的经典游戏，采用流畅的动画效果和现代化的视觉风格。游戏中你需要控制蛇头收集食物，避开障碍物，不断成长。随着等级的提升，游戏速度会逐渐增加，挑战你的反应能力。
                                </p>
                            </div>
                            <div>
                                <h4 class="font-medium mb-2">游戏特色</h4>
                                <ul class="space-y-2 text-gray-300">
                                    <li class="flex items-start">
                                        <i class="fa fa-check-circle text-primary mt-1 mr-2"></i>
                                        <span>流畅的动画效果，告别一顿一顿的移动</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fa fa-check-circle text-primary mt-1 mr-2"></i>
                                        <span>现代化的视觉效果，渐变背景和粒子效果</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fa fa-check-circle text-primary mt-1 mr-2"></i>
                                        <span>多个游戏模式和难度级别</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fa fa-check-circle text-primary mt-1 mr-2"></i>
                                        <span>障碍物和道具系统增加游戏趣味性</span>
                                    </li>
                                    <li class="flex items-start">
                                        <i class="fa fa-check-circle text-primary mt-1 mr-2"></i>
                                        <span>响应式设计，支持PC和移动设备</span>
                                    </li>
                                </ul>
                            </div>
                            <div>
                                <h4 class="font-medium mb-2">操作说明</h4>
                                <div class="grid grid-cols-2 gap-2 text-gray-300">
                                    <div class="flex items-center">
                                        <span class="w-12 text-center">↑</span>
                                        <span>向上移动</span>
                                    </div>
                                    <div class="flex items-center">
                                        <span class="w-12 text-center">W</span>
                                        <span>向上移动</span>
                                    </div>
                                    <div class="flex items-center">
                                        <span class="w-12 text-center">←</span>
                                        <span>向左移动</span>
                                    </div>
                                    <div class="flex items-center">
                                        <span class="w-12 text-center">A</span>
                                        <span>向左移动</span>
                                    </div>
                                    <div class="flex items-center">
                                        <span class="w-12 text-center">↓</span>
                                        <span>向下移动</span>
                                    </div>
                                    <div class="flex items-center">
                                        <span class="w-12 text-center">S</span>
                                        <span>向下移动</span>
                                    </div>
                                    <div class="flex items-center">
                                        <span class="w-12 text-center">→</span>
                                        <span>向右移动</span>
                                    </div>
                                    <div class="flex items-center">
                                        <span class="w-12 text-center">D</span>
                                        <span>向右移动</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 游戏统计 -->
                    <div class="bg-gray-800/50 border border-gray-700 rounded-xl p-6">
                        <h3 class="text-xl font-bold mb-4">游戏统计</h3>
                        <div class="space-y-4">
                            <div class="flex justify-between items-center">
                                <span class="text-gray-300">最高分</span>
                                <span class="font-medium" id="high-score">0</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-300">最长长度</span>
                                <span class="font-medium" id="max-length">0</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-300">游戏次数</span>
                                <span class="font-medium" id="game-count">0</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-300">总游戏时间</span>
                                <span class="font-medium" id="total-time">0 分钟</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 相关游戏 -->
            <div class="mt-16">
                <h2 class="text-2xl font-bold mb-6">相关游戏</h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4">
                    <!-- 相关游戏项 -->
                    <div
                        class="bg-gray-800/50 border border-gray-700 rounded-lg overflow-hidden hover:bg-gray-700 transition-colors">
                        <img src="?prompt=classic%20pacman%20game%20cover%2C%20modern%20design%2C%20dark%20theme&image_size=landscape_4_3"
                            alt="吃豆人" class="w-full h-40 object-cover">
                        <div class="p-4">
                            <h3 class="font-medium mb-2">吃豆人</h3>
                            <div class="flex items-center justify-between">
                                <span class="text-xs text-gray-400">休闲</span>
                                <button
                                    class="px-3 py-1 rounded-lg bg-primary hover:bg-primary/90 transition-colors text-sm">
                                    游玩
                                </button>
                            </div>
                        </div>
                    </div>
                    <div
                        class="bg-gray-800/50 border border-gray-700 rounded-lg overflow-hidden hover:bg-gray-700 transition-colors">
                        <img src="?prompt=tetris%20game%20cover%2C%20modern%20design%2C%20dark%20theme&image_size=landscape_4_3"
                            alt="俄罗斯方块" class="w-full h-40 object-cover">
                        <div class="p-4">
                            <h3 class="font-medium mb-2">俄罗斯方块</h3>
                            <div class="flex items-center justify-between">
                                <span class="text-xs text-gray-400">休闲</span>
                                <button
                                    class="px-3 py-1 rounded-lg bg-primary hover:bg-primary/90 transition-colors text-sm">
                                    游玩
                                </button>
                            </div>
                        </div>
                    </div>
                    <div
                        class="bg-gray-800/50 border border-gray-700 rounded-lg overflow-hidden hover:bg-gray-700 transition-colors">
                        <img src="?prompt=snake%20game%20cover%2C%20modern%20design%2C%20dark%20theme&image_size=landscape_4_3"
                            alt="贪吃蛇复古版" class="w-full h-40 object-cover">
                        <div class="p-4">
                            <h3 class="font-medium mb-2">贪吃蛇复古版</h3>
                            <div class="flex items-center justify-between">
                                <span class="text-xs text-gray-400">休闲</span>
                                <button
                                    class="px-3 py-1 rounded-lg bg-primary hover:bg-primary/90 transition-colors text-sm">
                                    游玩
                                </button>
                            </div>
                        </div>
                    </div>
                    <div
                        class="bg-gray-800/50 border border-gray-700 rounded-lg overflow-hidden hover:bg-gray-700 transition-colors">
                        <img src="?prompt=pong%20game%20cover%2C%20modern%20design%2C%20dark%20theme&image_size=landscape_4_3"
                            alt="乓乓球" class="w-full h-40 object-cover">
                        <div class="p-4">
                            <h3 class="font-medium mb-2">乓乓球</h3>
                            <div class="flex items-center justify-between">
                                <span class="text-xs text-gray-400">休闲</span>
                                <button
                                    class="px-3 py-1 rounded-lg bg-primary hover:bg-primary/90 transition-colors text-sm">
                                    游玩
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- 页脚 -->
    <footer class="bg-dark border-t border-gray-800 py-8 mt-auto">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-8">
                <div>
                    <div class="flex items-center space-x-2 mb-4">
                        <div class="w-10 h-10 rounded-lg bg-primary flex items-center justify-center">
                            <i class="fa fa-gamepad text-xl"></i>
                        </div>
                        <span
                            class="text-2xl font-bold bg-gradient-to-r from-primary to-secondary text-gradient">GamePortal</span>
                    </div>
                    <p class="text-gray-400 text-sm mb-4">
                        您的一站式游戏资源平台，提供最新最热的游戏和资源下载。
                    </p>
                    <div class="flex space-x-4">
                        <a href="#"
                            class="w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center hover:bg-primary/20 transition-colors">
                            <i class="fa fa-facebook"></i>
                        </a>
                        <a href="#"
                            class="w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center hover:bg-primary/20 transition-colors">
                            <i class="fa fa-twitter"></i>
                        </a>
                        <a href="#"
                            class="w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center hover:bg-primary/20 transition-colors">
                            <i class="fa fa-discord"></i>
                        </a>
                        <a href="#"
                            class="w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center hover:bg-primary/20 transition-colors">
                            <i class="fa fa-youtube-play"></i>
                        </a>
                    </div>
                </div>

                <div>
                    <h4 class="font-bold text-lg mb-4">快速链接</h4>
                    <ul class="space-y-2 text-gray-400">
                        <li><a href="index.html" class="hover:text-primary transition-colors">首页</a></li>
                        <li><a href="games.html" class="hover:text-primary transition-colors">游戏库</a></li>
                        <li><a href="downloads.html" class="hover:text-primary transition-colors">资源下载</a></li>
                        <li><a href="community.html" class="hover:text-primary transition-colors">社区</a></li>
                        <li><a href="login.html" class="hover:text-primary transition-colors">登录</a></li>
                        <li><a href="register.html" class="hover:text-primary transition-colors">注册</a></li>
                    </ul>
                </div>

                <div>
                    <h4 class="font-bold text-lg mb-4">支持</h4>
                    <ul class="space-y-2 text-gray-400">
                        <li><a href="#" class="hover:text-primary transition-colors">帮助中心</a></li>
                        <li><a href="#" class="hover:text-primary transition-colors">常见问题</a></li>
                        <li><a href="#" class="hover:text-primary transition-colors">联系我们</a></li>
                        <li><a href="#" class="hover:text-primary transition-colors">隐私政策</a></li>
                        <li><a href="#" class="hover:text-primary transition-colors">服务条款</a></li>
                    </ul>
                </div>

                <div>
                    <h4 class="font-bold text-lg mb-4">联系我们</h4>
                    <ul class="space-y-2 text-gray-400">
                        <li class="flex items-center">
                            <i class="fa fa-envelope mr-3 w-5"></i>
                            <span>support@gameportal.com</span>
                        </li>
                        <li class="flex items-center">
                            <i class="fa fa-phone mr-3 w-5"></i>
                            <span>+86 123 4567 8910</span>
                        </li>
                        <li class="flex items-center">
                            <i class="fa fa-map-marker mr-3 w-5"></i>
                            <span>北京市朝阳区游戏大厦</span>
                        </li>
                    </ul>
                </div>
            </div>

            <div class="border-t border-gray-800 pt-6 text-center text-gray-500 text-sm">
                <p>© 2024 GamePortal. 保留所有权利。</p>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script src="js/auth.js"></script>
    <script>
        // 导航栏滚动效果
        window.addEventListener('scroll', function () {
            const header = document.querySelector('header');
            if (window.scrollY > 50) {
                header.classList.add('py-2');
                header.classList.remove('py-3');
            } else {
                header.classList.add('py-3');
                header.classList.remove('py-2');
            }
        });

        // 现代贪吃蛇游戏
        class SnakeGame {
            constructor() {
                this.board = document.getElementById('game-board');
                this.scoreElement = document.getElementById('score');
                this.lengthElement = document.getElementById('length');
                this.levelElement = document.getElementById('level');
                this.highScoreElement = document.getElementById('high-score');
                this.maxLengthElement = document.getElementById('max-length');
                this.gameCountElement = document.getElementById('game-count');
                this.totalTimeElement = document.getElementById('total-time');

                this.startBtn = document.getElementById('start-btn');
                this.pauseBtn = document.getElementById('pause-btn');
                this.resetBtn = document.getElementById('reset-btn');

                this.init();
                this.bindEvents();
            }

            init() {
                // 游戏状态
                this.gameState = 'ready'; // ready, playing, paused, gameOver
                this.score = 0;
                this.level = 1;
                this.speed = 100; // 初始速度（毫秒）
                this.snake = [];
                this.direction = 'right';
                this.nextDirection = 'right';
                this.food = null;
                this.obstacles = [];
                this.powerUps = [];
                this.gameInterval = null;
                this.gameStartTime = null;
                this.totalGameTime = parseInt(localStorage.getItem('snakeTotalTime') || '0');

                // 统计数据
                this.highScore = parseInt(localStorage.getItem('snakeHighScore') || '0');
                this.maxLength = parseInt(localStorage.getItem('snakeMaxLength') || '0');
                this.gameCount = parseInt(localStorage.getItem('snakeGameCount') || '0');

                this.updateStats();

                // 初始化蛇
                this.snake = [
                    { x: 10, y: 10 },
                    { x: 9, y: 10 },
                    { x: 8, y: 10 }
                ];

                this.generateFood();
                this.generateObstacles();
                this.render();
            }

            bindEvents() {
                // 按钮事件
                this.startBtn.addEventListener('click', () => this.startGame());
                this.pauseBtn.addEventListener('click', () => this.togglePause());
                this.resetBtn.addEventListener('click', () => this.resetGame());

                // 键盘事件
                document.addEventListener('keydown', (e) => this.handleKeyPress(e));

                // 移动端控制
                document.querySelectorAll('.control-btn[data-direction]').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const direction = e.target.closest('.control-btn').dataset.direction;
                        this.changeDirection(direction);
                    });
                });
            }

            handleKeyPress(e) {
                switch (e.key) {
                    case 'ArrowUp':
                    case 'w':
                    case 'W':
                        this.changeDirection('up');
                        break;
                    case 'ArrowDown':
                    case 's':
                    case 'S':
                        this.changeDirection('down');
                        break;
                    case 'ArrowLeft':
                    case 'a':
                    case 'A':
                        this.changeDirection('left');
                        break;
                    case 'ArrowRight':
                    case 'd':
                    case 'D':
                        this.changeDirection('right');
                        break;
                    case ' ':
                        if (this.gameState === 'playing') {
                            this.togglePause();
                        } else if (this.gameState === 'ready' || this.gameState === 'gameOver') {
                            this.startGame();
                        }
                        break;
                }
            }

            changeDirection(newDirection) {
                // 防止180度转弯
                const oppositeDirections = {
                    up: 'down',
                    down: 'up',
                    left: 'right',
                    right: 'left'
                };

                if (newDirection !== oppositeDirections[this.direction]) {
                    this.nextDirection = newDirection;
                }
            }

            startGame() {
                if (this.gameState === 'ready' || this.gameState === 'gameOver') {
                    this.init();
                    this.gameState = 'playing';
                    this.gameStartTime = Date.now();
                    this.gameCount++;
                    localStorage.setItem('snakeGameCount', this.gameCount.toString());

                    this.startBtn.disabled = true;
                    this.pauseBtn.disabled = false;

                    this.gameInterval = setInterval(() => this.update(), this.speed);
                } else if (this.gameState === 'paused') {
                    this.resumeGame();
                }
            }

            pauseGame() {
                if (this.gameState === 'playing') {
                    this.gameState = 'paused';
                    clearInterval(this.gameInterval);
                    this.pauseBtn.innerHTML = '<i class="fa fa-play mr-2"></i>继续';
                }
            }

            resumeGame() {
                if (this.gameState === 'paused') {
                    this.gameState = 'playing';
                    this.gameInterval = setInterval(() => this.update(), this.speed);
                    this.pauseBtn.innerHTML = '<i class="fa fa-pause mr-2"></i>暂停';
                }
            }

            togglePause() {
                if (this.gameState === 'playing') {
                    this.pauseGame();
                } else if (this.gameState === 'paused') {
                    this.resumeGame();
                }
            }

            resetGame() {
                this.gameState = 'ready';
                clearInterval(this.gameInterval);
                this.init();

                this.startBtn.disabled = false;
                this.pauseBtn.disabled = true;
                this.pauseBtn.innerHTML = '<i class="fa fa-pause mr-2"></i>暂停';
            }

            update() {
                if (this.gameState !== 'playing') return;

                // 更新方向
                this.direction = this.nextDirection;

                // 计算新头部位置
                const head = { ...this.snake[0] };

                switch (this.direction) {
                    case 'up':
                        head.y--;
                        break;
                    case 'down':
                        head.y++;
                        break;
                    case 'left':
                        head.x--;
                        break;
                    case 'right':
                        head.x++;
                        break;
                }

                // 边界检测
                if (head.x < 0 || head.x >= 25 || head.y < 0 || head.y >= 25) {
                    this.gameOver();
                    return;
                }

                // 碰撞检测（自身）
                for (let i = 1; i < this.snake.length; i++) {
                    if (head.x === this.snake[i].x && head.y === this.snake[i].y) {
                        this.gameOver();
                        return;
                    }
                }

                // 碰撞检测（障碍物）
                for (const obstacle of this.obstacles) {
                    if (head.x === obstacle.x && head.y === obstacle.y) {
                        this.gameOver();
                        return;
                    }
                }

                // 食物检测
                if (head.x === this.food.x && head.y === this.food.y) {
                    this.score += 10 * this.level;
                    this.snake.unshift(head);
                    this.generateFood();

                    // 等级提升
                    if (this.score % 100 === 0) {
                        this.levelUp();
                    }
                } else {
                    // 移动蛇
                    this.snake.unshift(head);
                    this.snake.pop();
                }

                // 道具检测
                for (let i = 0; i < this.powerUps.length; i++) {
                    const powerUp = this.powerUps[i];
                    if (head.x === powerUp.x && head.y === powerUp.y) {
                        this.activatePowerUp();
                        this.powerUps.splice(i, 1);
                        break;
                    }
                }

                this.render();
                this.updateStats();
            }

            levelUp() {
                this.level++;
                this.speed = Math.max(50, this.speed - 5); // 最小速度50ms

                // 清除旧定时器，设置新定时器
                clearInterval(this.gameInterval);
                this.gameInterval = setInterval(() => this.update(), this.speed);

                // 每升一级生成新障碍物
                this.generateObstacles();

                // 偶尔生成道具
                if (Math.random() > 0.5) {
                    this.generatePowerUp();
                }
            }

            activatePowerUp() {
                // 道具效果：增加分数和长度
                this.score += 50;
                this.snake.unshift({ ...this.snake[0] });
            }

            generateFood() {
                let newFood;
                let valid = false;

                while (!valid) {
                    newFood = {
                        x: Math.floor(Math.random() * 25),
                        y: Math.floor(Math.random() * 25)
                    };

                    valid = true;

                    // 检查是否与蛇碰撞
                    for (const segment of this.snake) {
                        if (newFood.x === segment.x && newFood.y === segment.y) {
                            valid = false;
                            break;
                        }
                    }

                    // 检查是否与障碍物碰撞
                    if (valid) {
                        for (const obstacle of this.obstacles) {
                            if (newFood.x === obstacle.x && newFood.y === obstacle.y) {
                                valid = false;
                                break;
                            }
                        }
                    }
                }

                this.food = newFood;
            }

            generateObstacles() {
                // 每级生成2个障碍物
                const obstacleCount = this.level * 2;
                this.obstacles = [];

                for (let i = 0; i < obstacleCount; i++) {
                    let newObstacle;
                    let valid = false;

                    while (!valid) {
                        newObstacle = {
                            x: Math.floor(Math.random() * 25),
                            y: Math.floor(Math.random() * 25)
                        };

                        valid = true;

                        // 检查是否与蛇碰撞
                        for (const segment of this.snake) {
                            if (newObstacle.x === segment.x && newObstacle.y === segment.y) {
                                valid = false;
                                break;
                            }
                        }

                        // 检查是否与食物碰撞
                        if (valid && this.food) {
                            if (newObstacle.x === this.food.x && newObstacle.y === this.food.y) {
                                valid = false;
                            }
                        }

                        // 检查是否与其他障碍物碰撞
                        if (valid) {
                            for (const obstacle of this.obstacles) {
                                if (newObstacle.x === obstacle.x && newObstacle.y === obstacle.y) {
                                    valid = false;
                                    break;
                                }
                            }
                        }
                    }

                    this.obstacles.push(newObstacle);
                }
            }

            generatePowerUp() {
                let newPowerUp;
                let valid = false;

                while (!valid) {
                    newPowerUp = {
                        x: Math.floor(Math.random() * 25),
                        y: Math.floor(Math.random() * 25)
                    };

                    valid = true;

                    // 检查是否与蛇碰撞
                    for (const segment of this.snake) {
                        if (newPowerUp.x === segment.x && newPowerUp.y === segment.y) {
                            valid = false;
                            break;
                        }
                    }

                    // 检查是否与食物碰撞
                    if (valid && this.food) {
                        if (newPowerUp.x === this.food.x && newPowerUp.y === this.food.y) {
                            valid = false;
                        }
                    }

                    // 检查是否与障碍物碰撞
                    if (valid) {
                        for (const obstacle of this.obstacles) {
                            if (newPowerUp.x === obstacle.x && newPowerUp.y === obstacle.y) {
                                valid = false;
                                break;
                            }
                        }
                    }
                }

                this.powerUps.push(newPowerUp);

                // 道具30秒后消失
                setTimeout(() => {
                    this.powerUps = this.powerUps.filter(p => p.x !== newPowerUp.x || p.y !== newPowerUp.y);
                    this.render();
                }, 30000);
            }

            render() {
                // 清空游戏板
                this.board.innerHTML = '';

                // 渲染蛇
                this.snake.forEach((segment, index) => {
                    const snakeElement = document.createElement('div');
                    snakeElement.className = 'snake';
                    snakeElement.style.left = `${segment.x * 4}%`;
                    snakeElement.style.top = `${segment.y * 4}%`;

                    // 头部和身体颜色区分
                    if (index === 0) {
                        snakeElement.style.background = 'linear-gradient(45deg, #3b82f6, #2563eb)';
                    } else {
                        snakeElement.style.background = 'linear-gradient(45deg, #10b981, #059669)';
                    }

                    this.board.appendChild(snakeElement);
                });

                // 渲染食物
                if (this.food) {
                    const foodElement = document.createElement('div');
                    foodElement.className = 'food';
                    foodElement.style.left = `${this.food.x * 4}%`;
                    foodElement.style.top = `${this.food.y * 4}%`;
                    foodElement.style.background = 'linear-gradient(45deg, #f59e0b, #d97706)';
                    this.board.appendChild(foodElement);
                }

                // 渲染障碍物
                for (const obstacle of this.obstacles) {
                    const obstacleElement = document.createElement('div');
                    obstacleElement.className = 'obstacle';
                    obstacleElement.style.left = `${obstacle.x * 4}%`;
                    obstacleElement.style.top = `${obstacle.y * 4}%`;
                    this.board.appendChild(obstacleElement);
                }

                // 渲染道具
                for (const powerUp of this.powerUps) {
                    const powerUpElement = document.createElement('div');
                    powerUpElement.className = 'power-up';
                    powerUpElement.style.left = `${powerUp.x * 4}%`;
                    powerUpElement.style.top = `${powerUp.y * 4}%`;
                    this.board.appendChild(powerUpElement);
                }
            }

            updateStats() {
                this.scoreElement.textContent = this.score;
                this.lengthElement.textContent = this.snake.length;
                this.levelElement.textContent = this.level;
                this.highScoreElement.textContent = Math.max(this.highScore, this.score);
                this.maxLengthElement.textContent = Math.max(this.maxLength, this.snake.length);
                this.gameCountElement.textContent = this.gameCount;

                // 更新总游戏时间
                if (this.gameState === 'playing' && this.gameStartTime) {
                    const currentTime = Math.floor((Date.now() - this.gameStartTime) / 60000);
                    const totalTime = this.totalGameTime + currentTime;
                    this.totalTimeElement.textContent = `${totalTime} 分钟`;
                } else {
                    this.totalTimeElement.textContent = `${this.totalGameTime} 分钟`;
                }
            }

            gameOver() {
                this.gameState = 'gameOver';
                clearInterval(this.gameInterval);

                // 更新统计数据
                if (this.score > this.highScore) {
                    this.highScore = this.score;
                    localStorage.setItem('snakeHighScore', this.highScore.toString());
                }

                if (this.snake.length > this.maxLength) {
                    this.maxLength = this.snake.length;
                    localStorage.setItem('snakeMaxLength', this.maxLength.toString());
                }

                // 更新总游戏时间
                if (this.gameStartTime) {
                    this.totalGameTime += Math.floor((Date.now() - this.gameStartTime) / 60000);
                    localStorage.setItem('snakeTotalTime', this.totalGameTime.toString());
                }

                this.updateStats();

                // 更新按钮状态
                this.startBtn.disabled = false;
                this.pauseBtn.disabled = true;

                alert(`游戏结束！\n得分：${this.score}\n等级：${this.level}\n长度：${this.snake.length}`);
            }
        }

        // 初始化游戏
        document.addEventListener('DOMContentLoaded', function () {
            new SnakeGame();
        });
    </script>
</body>

</html>